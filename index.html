<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Tutor Pro | Clean UI</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
        :root {
            --bg-dark:#09090b; --card-bg:#141417; --accent:#6366f1;
            --text-main:#fafafa; --border:#27272a; --green:#10b981; --red:#ef4444;
        }
        body { margin:0; background:var(--bg-dark); color:var(--text-main); font-family:system-ui, sans-serif; overflow-x: hidden; }
        
        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .sidebar {
            position: fixed; top: 0; right: -100%; width: 85%; height: 100%;
            background: var(--card-bg); border-left: 1px solid var(--border);
            z-index: 1000; transition: 0.4s; padding: 20px; box-sizing: border-box;
            overflow-y: auto; box-shadow: -5px 0 15px rgba(0,0,0,0.5);
        }
        .sidebar.active { right: 0; }
        .overlay { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); display:none; z-index:999; }
        .overlay.active { display:block; }

        /* Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Ø§Ù„Ø¬Ø¯ÙˆÙ„) */
        .main-content { padding: 15px; }
        header { display: flex; justify-content: space-between; align-items: center; padding-bottom: 20px; }
        .menu-btn { background: var(--accent); border: none; color: white; padding: 10px 15px; border-radius: 10px; cursor: pointer; font-weight: bold; }

        .time-grid { border:1px solid var(--border); border-radius:15px; overflow:hidden; background:#000; width: 100%; }
        .day-row { display:flex; border-bottom:1px solid var(--border); min-height:70px; }
        .day-label { width:60px; font-size:12px; font-weight:bold; color:var(--accent); display:flex; align-items:center; justify-content:center; background:rgba(255,255,255,0.02); }
        .slots { flex:1; display:flex; overflow-x:auto; gap:8px; padding:10px; }
        .slot { flex-shrink:0; min-width:100px; padding:8px; border-radius:12px; text-align:center; color:#fff; font-size:11px; box-shadow: 0 4px 6px rgba(0,0,0,0.2); }
        .slot b { display: block; margin-bottom: 4px; border-bottom: 1px solid rgba(255,255,255,0.2); }

        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø¯Ø§Ø®Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© */
        .section-title { font-size: 14px; color: var(--accent); margin: 20px 0 10px; border-right: 3px solid var(--accent); padding-right: 8px; }
        input, select, button { width:100%; padding:12px; margin-bottom:10px; border-radius:12px; border:1px solid var(--border); background:#000; color:#fff; }
        #map { width: 100%; height: 180px; border-radius: 15px; margin-bottom: 15px; }
        .payment-item { display: flex; justify-content: space-between; align-items: center; background: #1c1c20; padding: 10px; border-radius: 12px; margin-bottom: 8px; border-right: 4px solid var(--red); }
        .payment-item.paid { border-right-color: var(--green); }
        .btn-pay { width: auto; padding: 5px 10px; background: var(--green); font-size: 10px; }
    </style>
</head>
<body>

<div class="overlay" id="overlay" onclick="toggleMenu()"></div>

<div class="sidebar" id="sidebar">
    <button onclick="toggleMenu()" style="background:var(--red); width: auto;">Ø¥ØºÙ„Ø§Ù‚ Ã—</button>
    
    <div class="section-title">ğŸ“ Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø·Ù„Ø§Ø¨</div>
    <div id="map"></div>

    <div class="section-title">ğŸ‘¤ Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</div>
    <input id="stuName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨">
    <input id="stuPrice" type="number" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº (Ø±ÙŠØ§Ù„)">
    <button onclick="addStudent()">Ø­ÙØ¸ Ø§Ù„Ø·Ø§Ù„Ø¨</button>

    <div class="section-title">â° Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯</div>
    <select id="stuSelect"></select>
    <input type="time" id="classTime">
    <select id="classDay">
        <option value="Sat">Ø§Ù„Ø³Ø¨Øª</option><option value="Sun">Ø§Ù„Ø£Ø­Ø¯</option>
        <option value="Mon">Ø§Ù„Ø§Ø«Ù†ÙŠÙ†</option><option value="Tues">Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option>
        <option value="Wed">Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option><option value="Thurs">Ø§Ù„Ø®Ù…ÙŠØ³</option>
    </select>
    <button style="background:var(--green)" onclick="addSchedule()">ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ÙˆØ¹Ø¯</button>

    <div class="section-title">ğŸ’° Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©</div>
    <div id="paymentList"></div>
</div>

<div class="main-content">
    <header>
        <h1 style="font-size: 22px; margin:0;">Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</h1>
        <button class="menu-btn" onclick="toggleMenu()">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© â˜°</button>
    </header>

    <div class="time-grid" id="mainGrid"></div>
</div>

<script>
    let students = JSON.parse(localStorage.getItem('tutor_pro_v11')) || [];
    const daysMap = {Sat:"Ø§Ù„Ø³Ø¨Øª", Sun:"Ø§Ù„Ø£Ø­Ø¯", Mon:"Ø§Ù„Ø§Ø«Ù†ÙŠÙ†", Tues:"Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", Wed:"Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡", Thurs:"Ø§Ù„Ø®Ù…ÙŠØ³"};

    // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
    let map = L.map('map').setView([25.3833, 49.5833], 12);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

    function toggleMenu() {
        document.getElementById('sidebar').classList.toggle('active');
        document.getElementById('overlay').classList.toggle('active');
    }

    function addStudent() {
        let name = document.getElementById('stuName').value;
        let price = document.getElementById('stuPrice').value;
        if(!name || !price) return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");

        students.push({
            id: Date.now(), name, price: parseFloat(price), isPaid: false,
            lat: 25.3833 + (Math.random() * 0.04 - 0.02),
            lng: 49.5833 + (Math.random() * 0.04 - 0.02),
            color: '#'+Math.floor(Math.random()*16777215).toString(16),
            schedules: []
        });
        save();
        document.getElementById('stuName').value = ""; document.getElementById('stuPrice').value = "";
    }

    function addSchedule() {
        let id = +document.getElementById('stuSelect').value;
        let time = document.getElementById('classTime').value;
        let day = document.getElementById('classDay').value;
        if(!id || !time) return alert("Ø§Ø®ØªØ± Ø§Ù„Ø·Ø§Ù„Ø¨ ÙˆØ§Ù„ÙˆÙ‚Øª");
        students.find(s => s.id === id).schedules.push({day, time});
        save();
        toggleMenu(); // ØºÙ„Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø¬Ø²
    }

    function togglePay(id) {
        let s = students.find(s => s.id === id);
        s.isPaid = !s.isPaid;
        save();
    }

    function save() {
        localStorage.setItem('tutor_pro_v11', JSON.stringify(students));
        render();
    }

    function render() {
        const grid = document.getElementById('mainGrid');
        const select = document.getElementById('stuSelect');
        const pList = document.getElementById('paymentList');
        
        grid.innerHTML = ''; select.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø·Ø§Ù„Ø¨</option>'; pList.innerHTML = '';
        map.eachLayer(l => { if(l instanceof L.Marker) map.removeLayer(l); });

        Object.keys(daysMap).forEach(d => {
            grid.innerHTML += `<div class="day-row"><div class="day-label">${daysMap[d]}</div><div class="slots" id="slot-${d}"></div></div>`;
        });

        students.forEach(s => {
            select.innerHTML += `<option value="${s.id}">${s.name}</option>`;
            L.marker([s.lat, s.lng]).addTo(map).bindPopup(s.name);

            pList.innerHTML += `
                <div class="payment-item ${s.isPaid ? 'paid' : ''}">
                    <span><b>${s.name}</b> (${s.price} Ø±.Ø³)</span>
                    <button class="btn-pay" onclick="togglePay(${s.id})">${s.isPaid ? 'ØªØ±Ø§Ø¬Ø¹' : 'ØªÙ…'}</button>
                </div>`;

            s.schedules.forEach(sc => {
                const dayBox = document.getElementById(`slot-${sc.day}`);
                if(dayBox) dayBox.innerHTML += `<div class="slot" style="background:${s.color}"><b>${sc.time}</b>${s.name}</div>`;
            });
        });
    }

    render();
</script>
</body>
</html>
